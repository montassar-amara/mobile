<div class="main-container">
  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">
        <p>New File</p>
        <span>File not selected</span>
      </button>
    </li>
    <li class="nav-item d-flex relative" role="presentation">
      <button class="nav-link" style="z-index: 1;" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">
        Current File
      </button>
      <button class="copy-btn button" (click)="copyPreviousFile()">
        
      </button>
    </li>
    <li style="height: 58px; line-height: 58px;" class="ms-auto">
      <button class="button" (click)="CancelSheetLoad()">Cancel</button>
    </li>
    <li style="height: 58px; line-height: 58px;" class="ms-2">
      <button class="button button--accent" *ngIf="!noExcelFile" (click)="addNewUpdate()">Update</button>
    </li>
  </ul>
  <div class="tab-content" style="width: 100%;" id="myTabContent">
    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
      <input class="selectDragExcelFile" *ngIf="noExcelFile" type="file" id="ExcelFileToSpreadJS" (change)="uploadExcelFile($event)">
      <label for="ExcelFileToSpreadJS" *ngIf="noExcelFile" class="dragdropExcelLabel">
        <div style="display: flex; flex-direction: column;">
          <div>
            <svg width="54" height="44" viewBox="0 0 54 44" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M44.1202 11.92C42.4908 8.17606 39.6788 5.06958 36.1151 3.07665C32.5513 1.08372 28.4324 0.314265 24.3894 0.886204C20.3465 1.45814 16.6027 3.33992 13.7315 6.24318C10.8604 9.14644 9.02043 12.911 8.49353 16.96C5.95109 17.5689 3.72079 19.0903 2.22616 21.2352C0.731539 23.3802 0.0766866 25.9993 0.385965 28.5953C0.695244 31.1913 1.94711 33.5832 3.90384 35.317C5.86057 37.0508 8.38587 38.0056 11.0002 38C11.7074 38 12.3857 37.7191 12.8858 37.219C13.3859 36.7189 13.6669 36.0406 13.6669 35.3334C13.6669 34.6261 13.3859 33.9479 12.8858 33.4478C12.3857 32.9477 11.7074 32.6667 11.0002 32.6667C9.58571 32.6667 8.22915 32.1048 7.22896 31.1046C6.22877 30.1044 5.66686 28.7479 5.66686 27.3334C5.66686 25.9189 6.22877 24.5623 7.22896 23.5621C8.22915 22.5619 9.58571 22 11.0002 22C11.7074 22 12.3857 21.7191 12.8858 21.219C13.3859 20.7189 13.6669 20.0406 13.6669 19.3334C13.6737 16.1795 14.7983 13.1301 16.8409 10.7269C18.8835 8.32382 21.7119 6.72258 24.8235 6.20771C27.9352 5.69284 31.1285 6.29766 33.8364 7.91473C36.5442 9.53181 38.5912 12.0564 39.6135 15.04C39.766 15.4983 40.04 15.9065 40.4063 16.2212C40.7726 16.5359 41.2175 16.7452 41.6935 16.8267C43.4697 17.1624 45.0799 18.0897 46.2616 19.4575C47.4434 20.8253 48.127 22.553 48.2013 24.3591C48.2755 26.1652 47.7359 27.9432 46.6703 29.4033C45.6048 30.8635 44.0762 31.9198 42.3335 32.4C41.6475 32.5769 41.0598 33.0189 40.6997 33.6291C40.3397 34.2392 40.2367 34.9674 40.4135 35.6534C40.5903 36.3394 41.0324 36.9271 41.6426 37.2872C42.2527 37.6472 42.9808 37.7502 43.6669 37.5734C46.4732 36.8318 48.9609 35.1947 50.7522 32.9106C52.5435 30.6266 53.5405 27.8203 53.5918 24.9181C53.643 22.0159 52.7458 19.1762 51.0364 16.8302C49.3269 14.4843 46.8986 12.7603 44.1202 11.92V11.92ZM28.8935 17.44C28.6399 17.1973 28.3409 17.007 28.0135 16.88C27.3643 16.6133 26.6361 16.6133 25.9869 16.88C25.6595 17.007 25.3605 17.1973 25.1069 17.44L17.1069 25.44C16.6047 25.9422 16.3226 26.6232 16.3226 27.3334C16.3226 28.0435 16.6047 28.7246 17.1069 29.2267C17.609 29.7289 18.2901 30.011 19.0002 30.011C19.7103 30.011 20.3914 29.7289 20.8935 29.2267L24.3335 25.76V40.6667C24.3335 41.374 24.6145 42.0522 25.1146 42.5523C25.6147 43.0524 26.293 43.3334 27.0002 43.3334C27.7074 43.3334 28.3857 43.0524 28.8858 42.5523C29.3859 42.0522 29.6669 41.374 29.6669 40.6667V25.76L33.1069 29.2267C33.3548 29.4767 33.6497 29.675 33.9747 29.8104C34.2996 29.9458 34.6482 30.0155 35.0002 30.0155C35.3522 30.0155 35.7008 29.9458 36.0257 29.8104C36.3507 29.675 36.6456 29.4767 36.8935 29.2267C37.1435 28.9788 37.3419 28.6839 37.4772 28.3589C37.6126 28.034 37.6823 27.6854 37.6823 27.3334C37.6823 26.9813 37.6126 26.6328 37.4772 26.3078C37.3419 25.9829 37.1435 25.6879 36.8935 25.44L28.8935 17.44Z" fill="#7E7E7E"/>
            </svg>
          </div>
          <div>
            Drag and drop file, or
            <span class="browse">Browse</span>
          </div>
          <div>
            <span class="available-extention">Available formats: xls, xlsx</span>
          </div>
        </div>
      </label>
      <ul class="sheets-list d-flex">
        <!-- <li *ngFor="let sheet of spreadAsJson" (click)="hideSheet(sheet)">{{ sheet.sheetname }}</li> -->
      </ul>
      <!--<button class="button" (click)="test()">Display Spread Content</button>
      <button class="btn btn-sm mx-2 btn-dark" style="min-width: 200px;" type="button" id="loadExcel"
      (click)="loadExcel($event)">Save init version</button>-->

      <div style="width: 100%; overflow: hidden;" *ngIf="!noExcelFile">
        <gc-spread-sheets [hostStyle]="hostStyle" (workbookInitialized)="initSpread($event)">
          <gc-worksheet>
          </gc-worksheet>
        </gc-spread-sheets>
      </div>
    </div>
    <div class="tab-pane fade" style="width: 100%;" id="profile" role="tabpanel" aria-labelledby="profile-tab">
      <div style="width: 100%; overflow: hidden;">
        <!--<gc-spread-sheets [hostStyle]="hostStyle" [ngStyle]="{'min-width': '100%'}" (workbookInitialized)="initCurrentSpread($event)">
          <gc-worksheet>
          </gc-worksheet>
        </gc-spread-sheets>-->
        <app-current-file></app-current-file>
      </div>
    </div>
  </div>
</div>
